<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin="anonymous">
		<link rel="dns-prefetch" href="//cdn.jsdelivr.net">
		<!-- meta -->
		<title>The Aviator</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=auto">
		<meta name="description" content="Flurry - A Three.js based web game imitating mobile game 'Loner'">
		<meta name="google" content="notranslate">
		<meta name="format-detection" content="telphone=no, email=no">
		<!-- Preload -->
		<link rel="modulepreload" href="scripts@core/base.js">
		<link rel="modulepreload" href="scripts@miscellaneous/webWorker.js">
  	<link rel="prefetch" href="scripts@miscellaneous/webWorker.js" as="worker" crossorigin="anonymous">
		<!-- scripts -->
		<script src="scripts@config/config.js"></script>
		<script async src="scripts@miscellaneous/webWorker.js"></script>
		<script type="text/javascript" src="//cdn.jsdelivr.net/gh/FML-MLS/Flurry/lib/three.min.js"></script>
		<script>try{THREE}catch(e){let script = document.createElement('SCRIPT'); script.src = "lib/three.min.js"; document.head.append(script)}</script>
		<script id="temp">
			let script = document.createElement('SCRIPT');
			script.type = "module";
			script.src = config.useNewBasejs ? "scripts@core/base.js" : "scripts@core/old_base.js";
			document.head.append(script);
			document.getElementById('temp').remove();
		</script>
		<script type="module" async>
			if("caches" in window && "serviceWorker" in navigator){
				window.addEventListener("load", ()=>{
					navigator.serviceWorker.register('serviceWorker.js', { scope: '/' }).then(reg => {
						if(reg.installing){
							console.info('[ServiceWorker] installing');
						}
					}).catch(error => {
						console.info('Registration failed with ' + error);
					})
				}, {passive: true, once: true});
			}
		</script>
		<!-- Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-179239422-1"></script>
		<script>
			window.dataLayer = [
				['js', new Date()],
				['config', 'UA-179239422-1']
			];
		</script>
		<!-- favicons -->
		<link rel="icon" href="favicon.ico">
		<meta name="theme-color" content="#f7d9aa">
		<link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/FML-MLS/Flurry/resource/favicons/safari-pinned-tab.svg">
		<link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/Flurry/resource/favicons/apple-touch-icon-180.png">
		<link rel="manifest" href="https://cdn.jsdelivr.net/gh/FML-MLS/Flurry/resource/favicons/manifest.webmanifest">
		<meta name="msapplication-config" content="https://cdn.jsdelivr.net/gh/FML-MLS/Flurry/resource/favicons/browserconfig.xml">
		<!-- styles -->
		<link href="resource/styles/style.css" rel="stylesheet" type="text/css">
	</head>
	<body>
		<section id="loading-section">
			<div id="loader">
				<script>
				if(existsCookie("loaded=true"))
					if(location.search.includes('app=1')) {
						document.getElementById("loader").hidden = "true";
						document.getElementById("loading-section").hidden = "true";
					} else {
						document.getElementById("loader").hidden = "true";
						config.loading_timeOut = 100;
					}
				else setCookie("loaded=true", 5)
				</script>
				<svg id="circular" viewBox="25 25 50 50">
					<circle id="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/>
				</svg>
			</div>
		</section>
		<section id="info">
				<noscript>
					JavaScript is required for processing...ðŸ˜”
					<style>
						#loading-section {
							display: none;
						}
					</style>
				</noscript>
				<script>
					setTimeout(()=>{
						if(document.getElementById('loading-section').hidden !== true){
							document.getElementById('loading-section').hidden = true;
							Dialog.newError('Loading takes too long.ðŸ˜¥', 10000)
						}
					}, 30000)
					if(window.matchMedia('screen and (orientation: portrait) and (max-width: 767px)').matches){
						Dialog.newError('Don\'t forget to change orientation to landscape :ï¼‰', 5000)
					}
				</script>
		</section>
		<main id="canvas"></main>
	</body>
</html>
